#### 4.4 Either 자료 형식

Option은 예외적인 조건이 발생했을 때 무엇이 잘못되었는지에 대한 정보를 제공하지 못한다는 단점을 가지고 있다. 실패시 Option은 그냥 유효한 값이 없음을 뜻하는 None을 돌려줄 뿐이다. 

그래서 Option을 간단하게 확장해서, 실패의 원인을 추적할 수 있는 Either를 만들어보겠다.

```scala
sealed trait Either[+E,+A]
case class Left[+E](value: E) extends Either[E, Nothing]
case class Right[+A](value: A) extends Either[Nothing, A]
```

- Option 처럼 case 가 두개이다. 
- Option과의 차이는 두 case모두 값을 가진다는 것이다. 
- Either는 둘 중 하나일 수 있는 값들을 대표한다고 할 수 있다. 
- 성공했을 때는 Right/ 실패 했을 때는 Left를 사용한다. (E는 error의 E)



######실패의 경우 String 을 돌려주는 mean 

```scala
def mean(xs: IndexedSeq[Double]): Either[String, Double] = {
    if(xs.isEmpty)
    	Left("mean of empty list")
    else 
    	Right(xs.sum/xs.length)
}
```

오류에 대한 추가정보, 이를 테면 소스코드에서 오류가 발생한 위치를 알 수 있는 스택 추적 정보가 있으면 Either의 Left쪽에서 그냥 예외를 돌려주면 된다. 

```scala
def safeDiv(x:Int, y:Int) : Either[Exception, Int] = {
    try Right(x/y)
    catch{case e: Exception => Left(e)}
}
```

Option 에서 했듯이, 던져진 예외를 값으로 변환한다는 이러한 공통의 패턴을 추출한 함수 Try는

```scala
def Try[A](a: => A):Either[Exception, A] = {
    try Right(a)
    catch{case e:Exception => Left(e)}
}
```

앞서 나왔던  parseInsuranceRateQuote는 다음과 같이 바꿀 수 있다.

```scala
def parseInsuranceRateQuote(age: String, numberOfSpeedingTickets: String): Either[Exception, Double] = {
    for{
        a <- Try{ age. toInt }
        tickets <- Try{numberOfSpeedingTickets.toInt}
    } yield insuranceRateQuote(a, tickets)
}
```

이제는 실패시 그냥 None이 아니라 발생한 실제 예외에 대한 정보를 얻게 되었다. 



